version: '3.9'

services:
  cyclone:
    image: 'webmakom/cyclone:0.0.10'
    restart: always
    ports:
      - "3231:3231" # http api
      - "3203:3203" # p2p
    environment:
      CYCLONE_LABEL: 'p1'
      CYCLONE_PEERS: '164.68.127.67:3203,164.68.127.58:3203'
      CYCLONE_PK: 'KwUjLXVF19uTjp5FnQrb4vmiEVQYgApdqAJDTUQ1T9C1wXirTTHS'
      CYCLONE_PUB: '020e119b3e3799afc17f7371c1a10a6fd38ced2d6662a1528d6675c8322de19234'
      CYCLONE_ADDR: '1Mxn3tAYPWogMqfD1geqiaqpAnjguPYAXF'
    depends_on:
      - storage
      - vm
      - crypto
    network_mode: 'host'

  vm:
    image: 'webmakom/vm:0.0.8'
    restart: always
    ports:
      - "8039:8039" # http api
    environment:
      VM_GENESIS_NATIVE: '1Mxn3tAYPWogMqfD1geqiaqpAnjguPYAXF:100000,1HSqakjKkwBR2YtXkxfUsfu2y7QEm1pDjN:100000,1L3cxnDxCYUuyzHgu9N4cexR7zeSEoLJvo:100000'
      VM_GENESIS_VALIDATORS: '1Mxn3tAYPWogMqfD1geqiaqpAnjguPYAXF,1HSqakjKkwBR2YtXkxfUsfu2y7QEm1pDjN,1L3cxnDxCYUuyzHgu9N4cexR7zeSEoLJvo'
    depends_on:
      - storage
    network_mode: 'host'

  gw:
    image: 'webmakom/gw:0.0.7'
    restart: always
    ports:
      - "9231:9231" # http api
    depends_on:
      - storage
      - crypto
    network_mode: 'host'

  crypto:
    image: 'webmakom/crypto:0.0.2'
    restart: always
    ports:
      - "3305:3305" # http api
    network_mode: 'host'

  storage:
    image: 'webmakom/storage:0.0.4'
    ports:
      - 8801:8801
      - 8802:8802
    depends_on:
      - mongo-db
    network_mode: 'host'

  mongo-db:
    image: mongo:latest
    volumes:
      - mongo_data:/data/db
    network_mode: 'host'
    ports:
      - 27017:27017

volumes:
  mongo_data: {}